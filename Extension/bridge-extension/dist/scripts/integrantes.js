function crearEncabezado(){let e=document.createElement("th");e.style.textAlign="center",e.setAttribute("data-field","2");let n=document.createElement("div");n.className="th-inner",n.textContent="Bridge";let t=document.createElement("div");t.className="fht-cell",e.appendChild(n),e.appendChild(t);let s=document.querySelector("#tableintegrantes > thead > tr");s.insertBefore(e,s.children[2])}function cargarIntegrantesNeo4j(){console.log("Leyendo integrantes...");let e=document.querySelectorAll("#tableintegrantes > tbody > tr"),n=[];for(let t of e){let e={name:t.children[1].textContent.trim(),username:t.children[2].textContent.trim().toLowerCase(),legajo:t.children[3].textContent.trim()};"Alumno"==t.children[4].textContent.trim()&&n.push(e)}console.log(n);const t=new Headers;t.append("Content-Type","application/json");let s="Basic "+btoa("sacarle@uade.edu.ar:password");t.append("Authorization",s);let o=window.location.href.split("="),l=o[o.length-1],i=[];fetch("http://localhost:8080/api/v1/cursos/usuariosDeCurso?courseCode="+l,{method:"GET",redirect:"follow"}).then((e=>e.text())).then((e=>i=JSON.parse(e))).then((()=>{let e=i.users.map((e=>e.username));console.log(e);let s=n.filter((n=>!e.includes(n.username)));fetch("http://localhost:8080/api/v1/auth/preRegisterUsers",{method:"POST",headers:t,body:JSON.stringify(s)}).then((e=>console.log(e))).then((()=>{let e={courseCode:l,usernames:n.map((e=>e.username))};console.log(e),fetch("http://localhost:8080/api/v1/cursos/agregarVariosUsuariosACurso",{method:"POST",headers:t,body:JSON.stringify(e)}).then((e=>console.log(e))).catch((e=>{console.error("Error:",e)}))})).catch((e=>{console.error("Error:",e)}))})).catch((e=>console.error(e)))}function agregarBotonACadaFila(){let e=document.querySelectorAll("#tableintegrantes > tbody > tr");for(let n of e){let e=document.createElement("td");e.style.textAlign="center";let t=document.createElement("a"),s=document.createElement("img");s.src="https://i.imgur.com/7sYdczi.png",s.style.width="50px";let o=n.children[2].textContent.trim();t.id="botonPerfil-"+o,t.appendChild(s),t.addEventListener("click",(function(e){e.preventDefault(),cargarPerfil(o);let t=n.nextElementSibling;t&&t.classList.toggle("d-none")})),e.appendChild(t),n.insertBefore(e,n.children[2]);let l=`<tr class="d-none">\n          <td colspan="6">\n            <table style="width: 100%">\n              <thead>\n                <tr>\n                  <td colspan="6">Presentacion</td>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td id="presentacion-${o}" colspan="6">\n                    Cargando Presentacion...\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n            <table style="width: 100%">\n              <thead>\n                <tr>\n                  <td colspan="6">Comentarios</td>\n                </tr>\n              </thead>\n              <tbody id="comentariosContainer-${o}">\n                <tr>\n                  <td>Cargando Comentarios...</td>\n                </tr>\n              </tbody>\n            </table>\n\n            <table style="width: 100%">\n              <thead>\n                <tr>\n                  <td colspan="6">Portfolio</td>\n                </tr>\n              </thead>\n              <tbody id="proyectosContainer-${o}">\n                <tr>\n                  <td>Cargando Proyectos...</td>\n                </tr>\n              </tbody>\n            </table>\n          </td>\n        </tr>\n        <tr class="d-none"></tr>`;n.insertAdjacentHTML("afterend",l)}}function completarPerfil(e,n){document.getElementById("presentacion-"+e).textContent=n.introduction;let t=n.comments.map((e=>`<li>\n            <div>\n              <div style="display: flex; justify-content: space-between;">\n                <p>De: ${e.remitente}</p>\n                <p>${e.timestamp}</p>\n              </div>\n              <p>${e.mensaje}</p>\n              \n            </div>    \n            \n          </li>`)).join("");document.getElementById("comentariosContainer-"+e).innerHTML=`\n        <tr>\n                  <td>\n                    <ul style="margin: 0; padding: 0; list-style-type: none; display:flex; flex-direction:column; justify-content:space-between; height:100%; width: 100%">\n                      <li style="flex-grow:1">\n                        <button style="width:100%; margin:0; padding:0" id="btnPrevComentario-${e}">Prev</button>\n                      </li>\n                      <li style="flex-grow:1">\n                        <button style="width:100%; margin:0; padding:0" id="btnNextComentario-${e}">Next</button>\n                      </li>\n                    </ul>\n                  </td>\n                  <td colspan="5">\n                    <div\n                      id="comentariosContainer"\n                      style="position: relative; overflow: hidden"\n                    >\n                      <ul\n                        id="comentarios-${e}"\n                        style="margin: 0; padding: 0; list-style-type: none"\n                      >\n                        `+t+"\n                      </ul>\n                    </div>\n                  </td>\n                </tr>";let s=n.projects.map((e=>`<li>\n              <div style="display: flex; justify-content: space-between">\n              <h3>${e.titulo}</h3>\n              <p>Curso: ${e.curso.name}</p>\n              </div>\n            <div style="display: flex">\n            <img\n              style="max-width: 200px; max-height: 100px"\n              src="${e.portadaLink}"\n              alt="ImagenProyecto"\n            />\n            <p>\n              ${e.descripcion}\n            </p>\n            </div>\n            <div>\n              <h4>Links</h4>\n              <ul style="list-style-type: none;">\n                `+e.links.map((e=>`<li><a href="${e}" target="blank">${e}</a></li>`)).join("")+`\n              </ul>\n            </div>\n            <div>\n              <h4>Equipo: ${e.equipo.nombre}</h4>\n              <ul style="list-style-type: none;">\n                `+e.members.map((e=>`<li style="display:flex; justify-content: space-between">\n                      <a href="localhost:5173/profile/${e.username}" target="blank">${e.name}</a>\n                      <div>${e.username}</div>\n                      <div>${e.legajo}</div>\n                    </li>`)).join("")+"\n              </ul>\n            </div>\n          </li>")).join("");document.getElementById("proyectosContainer-"+e).innerHTML=`\n          <tr>\n                  <td colspan="6">                    \n                    <ul\n                      id="portfolio-${e}"\n                      style="margin: 0; padding: 0; list-style-type: none;"\n                    >\n                      `+s+`\n                    </ul>\n                  </td>\n                </tr>\n                <tr>\n                  <td colspan="3">\n                    <button id="btnPrevProyecto-${e}" style="width: 100%">\n                      Prev\n                    </button>\n                  </td>\n                  <td colspan="3">\n                    <button id="btnNextProyecto-${e}" style="width: 100%">\n                      Next\n                    </button>\n                  </td>\n                </tr>\n        `,setAnimacionesCarrousel(e)}function cargarPerfil(e){if(perfilesCargados.includes(e))return;console.log("Cargando perfil de "+e);let n={};fetch("http://localhost:8080/api/v1/profile/?username="+e,{method:"GET",redirect:"follow"}).then((e=>e.text())).then((e=>n=JSON.parse(e))).then((()=>completarPerfil(e,n))).catch((e=>console.error(e))),perfilesCargados.push(e)}function agregarEstilos(){let e=document.createElement("style");e.textContent=".slide-in {\n    animation: slide-in 0.5s forwards;\n    z-index: -1;\n  }\n\n  .slide-out {\n    animation: slide-out 0.5s forwards;\n    z-index: -1;\n  }\n\n  @keyframes slide-in {\n    0% { transform: translateY(100%); }\n    100% { transform: translateY(0); }\n  }\n\n  @keyframes slide-out {\n    0% { transform: translateY(0); }\n    100% { transform: translateY(-100%); }\n  }\n\n  .slide-in-reverse {\n    animation: slide-in-reverse 0.5s forwards;\n  }\n  \n  .slide-out-reverse {\n    animation: slide-out-reverse 0.5s forwards;\n  }\n  \n  @keyframes slide-in-reverse {\n    0% { transform: translateY(-100%); }\n    100% { transform: translateY(0); }\n  }\n  \n  @keyframes slide-out-reverse {\n    0% { transform: translateY(0); }\n    100% { transform: translateY(100%); }\n  }\n\n  .slide-in-left {\n    animation: slide-in-left 0.5s forwards;\n  }\n\n  .slide-out-left {\n    animation: slide-out-left 0.5s forwards;\n  }\n\n  @keyframes slide-in-left {\n    0% { transform: translateX(100%); }\n    100% { transform: translateX(0); }\n  }\n\n  @keyframes slide-out-left {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-100%); }\n  }\n\n  .slide-in-left {\n    animation: slide-in-left 0.5s forwards;\n  }\n\n  .slide-out-left {\n    animation: slide-out-left 0.5s forwards;\n  }\n\n  @keyframes slide-in-left {\n    0% { transform: translateX(100%); }\n    100% { transform: translateX(0); }\n  }\n\n  @keyframes slide-out-left {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-100%); }\n  }\n\n  .slide-in-right {\n    animation: slide-in-right 0.5s forwards;\n  }\n\n  .slide-out-right {\n    animation: slide-out-right 0.5s forwards;\n  }\n\n  @keyframes slide-in-right {\n    0% { transform: translateX(-100%); }\n    100% { transform: translateX(0); }\n  }\n\n  @keyframes slide-out-right {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(100%); }\n  }",document.head.appendChild(e)}function setAnimacionesCarrousel(e){let n=document.getElementById("comentarios-"+e).children,t=document.getElementById("btnNextComentario-"+e),s=document.getElementById("btnPrevComentario-"+e),o=0;for(let e=0;e<n.length;e++)n[e].style.display="none";n.length>0&&(n[0].style.display="block"),t.addEventListener("click",(function(e){e.preventDefault(),n[o].classList.add("slide-out"),setTimeout((function(){n[o].style.display="none",n[o].classList.remove("slide-out"),o=(o+1)%n.length,n[o].style.display="block",n[o].classList.add("slide-in"),setTimeout((function(){n[o].classList.remove("slide-in")}),500)}),500)})),s.addEventListener("click",(function(e){e.preventDefault(),n[o].classList.add("slide-out-reverse"),setTimeout((function(){n[o].style.display="none",n[o].classList.remove("slide-out-reverse"),o=(o-1+n.length)%n.length,n[o].style.display="block",n[o].classList.add("slide-in-reverse"),setTimeout((function(){n[o].classList.remove("slide-in-reverse")}),500)}),500)}));for(var l=document.getElementById(`portfolio-${e}`).children,i=document.getElementById("btnNextProyecto-"+e),r=document.getElementById("btnPrevProyecto-"+e),a=0,d=1;d<l.length;d++)l[d].style.display="none";i.addEventListener("click",(function(e){e.preventDefault(),l[a].classList.add("slide-out-left"),setTimeout((function(){l[a].style.display="none",l[a].classList.remove("slide-out-left"),a=(a+1)%l.length,console.log(a),a<l.length?(l[a].style.display="block",l[a].classList.add("slide-in-left")):(l[0].style.display="block",l[a=0].classList.add("slide-in-left")),console.log(l.length),console.log(a),setTimeout((function(){l[a].classList.remove("slide-in-left")}),500)}),500)})),r.addEventListener("click",(function(e){e.preventDefault(),l[a].classList.add("slide-out-right"),setTimeout((function(){l[a].style.display="none",l[a].classList.remove("slide-out-right"),(a=(a-1+l.length)%l.length)>=0?(l[a].style.display="block",l[a].classList.add("slide-in-right")):(l[l.length-1].style.display="block",a=l.length-1,l[a].classList.add("slide-in-right")),console.log(l.length),console.log(a),setTimeout((function(){l[a].classList.remove("slide-in-right")}),500)}),500)}))}chrome.runtime.onMessage.addListener((function(e,n,t){console.log(e),void 0!==e.nombre&&void 0!==e.encendido&&console.log(e.nombre+" was toggled. New state: "+e.encendido)}));let perfilesCargados=[];cargarIntegrantesNeo4j(),crearEncabezado(),agregarBotonACadaFila(),agregarEstilos(),setAnimacionesCarrousel();