function crearEncabezado(){let e=document.createElement("th");e.style.textAlign="center",e.setAttribute("data-field","2");let t=document.createElement("div");t.className="th-inner",t.textContent="Bridge";let n=document.createElement("div");n.className="fht-cell",e.appendChild(t),e.appendChild(n);let r=document.querySelector("#tableintegrantes > thead > tr");r.insertBefore(e,r.children[2])}function cargarIntegrantesNeo4j(){console.log("Leyendo integrantes...");let e=document.querySelectorAll("#tableintegrantes > tbody > tr"),t=[];for(let n of e){let e={name:n.children[1].textContent.trim(),username:n.children[2].textContent.trim().toLowerCase(),legajo:n.children[3].textContent.trim()};"Alumno"==n.children[4].textContent.trim()&&t.push(e)}console.log(t);const n=new Headers;n.append("Content-Type","application/json");let r="Basic "+btoa("sacarle@uade.edu.ar:password");n.append("Authorization",r);let o=window.location.href.split("="),s=o[o.length-1],i=[];fetch("http://localhost:8080/api/v1/cursos/usuariosDeCurso?courseCode="+s,{method:"GET",redirect:"follow"}).then((e=>e.text())).then((e=>i=JSON.parse(e))).then((()=>{let e=i.users.map((e=>e.username));console.log(e);let r=t.filter((t=>!e.includes(t.username)));fetch("http://localhost:8080/api/v1/auth/preRegisterUsers",{method:"POST",headers:n,body:JSON.stringify(r)}).then((e=>console.log(e))).then((()=>{let e={courseCode:s,usernames:t.map((e=>e.username))};console.log(e),fetch("http://localhost:8080/api/v1/cursos/agregarVariosUsuariosACurso",{method:"POST",headers:n,body:JSON.stringify(e)}).then((e=>console.log(e))).catch((e=>{console.error("Error:",e)}))})).catch((e=>{console.error("Error:",e)}))})).catch((e=>console.error(e)))}function agregarBotonACadaFila(){let e=document.querySelectorAll("#tableintegrantes > tbody > tr");for(let t of e){let e=document.createElement("td");e.style.textAlign="center";let n=document.createElement("a"),r=document.createElement("img");r.src="https://i.imgur.com/7sYdczi.png",r.style.width="50px";let o=t.children[2].textContent.trim();n.id="botonPerfil-"+o,n.appendChild(r),n.addEventListener("click",(function(e){e.preventDefault(),cargarPerfil(o);let n=t.nextElementSibling;n&&n.classList.toggle("d-none")})),e.appendChild(n),t.insertBefore(e,t.children[2]);let s=`<tr class="d-none">\n          <td style="background: #F0E9FF;border-radius: 10px;" colspan="6">\n            <table style="width: 100%">\n              <thead>\n                <tr>\n                  <td style="border-radius: 10px;" colspan="5"><h5 style="margin:5px">Presentaci√≥n</h5></td>\n                  <td style="border-radius: 10px;" colspan="1"><h5 style="margin:5px">Habilidades</h5></td>\n                </tr>\n              </thead>\n              <tbody>\n                <tr>\n                  <td style="border-radius: 10px;vertical-align:top" id="presentacion-${o}" colspan="5">\n                    Cargando Presentacion...\n                  </td>\n                  <td id="skills-${o}" colspan="1" style="box-sizing: border-box;width: 200px;border-radius: 10px;">\n                    Cargando Skills...\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n            <table style="width: 100%">\n              <thead>\n                <tr>\n                  <td style="border-radius: 10px;" colspan="6"><h5 style="margin:5px">Comentarios</h5></td>\n                </tr>\n              </thead>\n              <tbody id="comentariosContainer-${o}">\n                <tr>\n                  <td style="border-radius: 10px;">Cargando Comentarios...</td>\n                </tr>\n              </tbody>\n            </table>\n\n            <table style="width: 100%">\n              <thead>\n                <tr>\n                  <td style="border-radius: 10px;" colspan="6"><h5 style="margin:5px">Portfolio</h5></td>\n                </tr>\n              </thead>\n              <tbody id="proyectosContainer-${o}">\n                <tr>\n                  <td style="border-radius: 10px;">Cargando Proyectos...</td>\n                </tr>\n              </tbody>\n            </table>\n          </td>\n        </tr>\n        <tr class="d-none"></tr>`;t.insertAdjacentHTML("afterend",s)}}function completarPerfil(e,t){document.getElementById("presentacion-"+e).textContent=t.introduction,document.getElementById("presentacion-"+e).style.padding="10px",document.getElementById("skills-"+e).innerHTML=`\n          <canvas id="skillsChart-${e}" height="200" width="400"></canvas>\n        `;var n=document.getElementById(`skillsChart-${e}`).getContext("2d"),r=Object.keys(t.skills),o=Object.values(t.skills);new Chart(n,{type:"radar",data:{labels:r,datasets:[{data:o,fill:!0,backgroundColor:"rgb(255, 128, 110, 0.3)",borderColor:"#00BCC6",pointBackgroundColor:"#00BCC6",pointBorderColor:"#fff",pointHoverBackgroundColor:"#fff",pointHoverBorderColor:"#00BCC6",borderWidth:1}]},options:{responsive:!1,maintainAspectRatio:!1,scales:{r:{ticks:{beginAtZero:!0,fontSize:4,backdropColor:"transparent",fontColor:"black"},pointLabels:{fontSize:16}}},plugins:{legend:{display:!1}}}});const s={year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"};let i=t.comments.map((e=>`<li>\n      <div>\n        <div style="display: flex; justify-content: space-between; border-bottom: 2px solid black;padding: 5px;margin-bottom: 5px;">\n          <p style="margin:0px" >De: ${e.remitente}</p>\n          <p style="margin:0px">${new Intl.DateTimeFormat("es-ES",s).format(new Date(e.timestamp))}</p>\n        </div>\n        <p style="margin: 5px">${e.mensaje}</p>\n        \n      </div>    \n      \n    </li>`)).join("");document.getElementById("comentariosContainer-"+e).innerHTML=`\n  <tr>\n            <td style="height:100%;width: 150px; border-radius: 10px;">\n              <ul style="margin: 0; padding: 0; list-style-type: none; display:flex; flex-direction:column; justify-content:space-between; height:100px; width: 100%">\n                <li style="flex-grow:1; margin: 5px">\n                  <button style="cursor: pointer;width:100%; height:100%; margin:0; padding:0; border-radius: 10px; background: #FF806E" id="btnPrevComentario-${e}">Anterior</button>\n                </li>\n                <li style="flex-grow:1; margin: 5px">\n                  <button style="cursor: pointer;width:100%; height:100%; margin:0; padding:0; border-radius: 10px; background: #00BCC6" id="btnNextComentario-${e}">Siguiente</button>\n                </li>\n              </ul>\n            </td>\n            <td colspan="5" style="vertical-align:top; border-radius: 10px;">\n              <div\n                id="comentariosContainer"\n                style="position: relative; overflow: hidden; height:fit-content"\n              >\n                <ul\n                  id="comentarios-${e}"\n                  style="margin: 0; padding: 0; list-style-type: none"\n                >\n                  `+i+"\n                </ul>\n              </div>\n            </td>\n          </tr>";let l=t.projects.map((e=>`<li>\n        <div style="display: flex;justify-content: space-between;margin-bottom: 5px;padding: 5px;border-bottom: 2px solid black;align-items: end;">\n        <h3 style="margin:0px">${e.titulo}</h3>\n        <p style="margin:0px">Curso: ${e.curso.name}</p>\n        </div>\n      <div style="display: flex; margin:10px">\n      <img\n        style="max-width: 200px; max-height: 100px;"\n        src="${e.portadaLink}"\n        alt="ImagenProyecto"\n      />\n      <div style="margin-left: 10px;width: 100%;border: 1px solid grey; border-radius: 10px">\n        <p style="width: 100%;height: fit-content; margin:5px">\n          ${e.descripcion}\n        </p>\n      </div>\n      </div>\n      <div>\n        <h5 style="margin: 5px;border-bottom: 2px solid grey">Links</h4>\n        <ul style="list-style-type: none;">\n          `+e.links.map((e=>`<li><a href="${e}" target="blank">${e}</a></li>`)).join("")+`\n        </ul>\n      </div>\n      <div>\n        <h5 style="margin: 5px;border-bottom: 2px solid grey">Equipo: ${e.equipo.nombre}</h4>\n        <ul style="list-style-type: none;">\n          `+e.members.map((e=>`<li style="display:flex; justify-content: space-between">\n                <a style="width: 35%" href="localhost:5173/perfil/${e.username}" target="blank">${e.name}</a>\n                <div style="width: 35%">${e.username}</div>\n                <div style="width: 30%">${e.legajo}</div>\n              </li>`)).join("")+"\n        </ul>\n      </div>\n    </li>")).join("");document.getElementById("proyectosContainer-"+e).innerHTML=`\n    <tr>\n            <td style="border-radius: 10px;" colspan="6">                    \n              <ul\n                id="portfolio-${e}"\n                style="margin: 0; padding: 0; list-style-type: none;"\n              >\n                `+l+`\n              </ul>\n            </td>\n          </tr>\n          <tr>\n            <td style="border-radius: 10px; padding:5px" colspan="3">\n              <button id="btnPrevProyecto-${e}" style="cursor: pointer;width: 100%; border-radius: 10px; background: #FF806E">\n                Anterior\n              </button>\n            </td>\n            <td style="border-radius: 10px; padding:5px" colspan="3">\n              <button id="btnNextProyecto-${e}" style="cursor: pointer;width: 100%;border-radius: 10px; background: #00BCC6">\n                Siguiente\n              </button>\n            </td>\n          </tr>\n  `,setAnimacionesCarrousel(e)}function cargarPerfil(e){if(perfilesCargados.includes(e))return;console.log("Cargando perfil de "+e);let t={};fetch("http://localhost:8080/api/v1/profile/?username="+e,{method:"GET",redirect:"follow"}).then((e=>e.text())).then((e=>t=JSON.parse(e))).then((()=>completarPerfil(e,t))).catch((e=>console.error(e))),perfilesCargados.push(e)}function agregarEstilos(){let e=document.createElement("style");e.textContent=".slide-in {\n    animation: slide-in 0.5s forwards;\n    z-index: -1;\n  }\n\n  .slide-out {\n    animation: slide-out 0.5s forwards;\n    z-index: -1;\n  }\n\n  @keyframes slide-in {\n    0% { transform: translateY(100%); }\n    100% { transform: translateY(0); }\n  }\n\n  @keyframes slide-out {\n    0% { transform: translateY(0); }\n    100% { transform: translateY(-100%); }\n  }\n\n  .slide-in-reverse {\n    animation: slide-in-reverse 0.5s forwards;\n  }\n  \n  .slide-out-reverse {\n    animation: slide-out-reverse 0.5s forwards;\n  }\n  \n  @keyframes slide-in-reverse {\n    0% { transform: translateY(-100%); }\n    100% { transform: translateY(0); }\n  }\n  \n  @keyframes slide-out-reverse {\n    0% { transform: translateY(0); }\n    100% { transform: translateY(100%); }\n  }\n\n  .slide-in-left {\n    animation: slide-in-left 0.5s forwards;\n  }\n\n  .slide-out-left {\n    animation: slide-out-left 0.5s forwards;\n  }\n\n  @keyframes slide-in-left {\n    0% { transform: translateX(100%); }\n    100% { transform: translateX(0); }\n  }\n\n  @keyframes slide-out-left {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-100%); }\n  }\n\n  .slide-in-left {\n    animation: slide-in-left 0.5s forwards;\n  }\n\n  .slide-out-left {\n    animation: slide-out-left 0.5s forwards;\n  }\n\n  @keyframes slide-in-left {\n    0% { transform: translateX(100%); }\n    100% { transform: translateX(0); }\n  }\n\n  @keyframes slide-out-left {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(-100%); }\n  }\n\n  .slide-in-right {\n    animation: slide-in-right 0.5s forwards;\n  }\n\n  .slide-out-right {\n    animation: slide-out-right 0.5s forwards;\n  }\n\n  @keyframes slide-in-right {\n    0% { transform: translateX(-100%); }\n    100% { transform: translateX(0); }\n  }\n\n  @keyframes slide-out-right {\n    0% { transform: translateX(0); }\n    100% { transform: translateX(100%); }\n  }",document.head.appendChild(e)}function setAnimacionesCarrousel(e){let t=document.getElementById("comentarios-"+e).children,n=document.getElementById("btnNextComentario-"+e),r=document.getElementById("btnPrevComentario-"+e),o=0;for(let e=0;e<t.length;e++)t[e].style.display="none";t.length>0&&(t[0].style.display="block"),n.addEventListener("click",(function(e){e.preventDefault(),t[o].classList.add("slide-out"),setTimeout((function(){t[o].style.display="none",t[o].classList.remove("slide-out"),o=(o+1)%t.length,t[o].style.display="block",t[o].classList.add("slide-in"),setTimeout((function(){t[o].classList.remove("slide-in")}),500)}),500)})),r.addEventListener("click",(function(e){e.preventDefault(),t[o].classList.add("slide-out-reverse"),setTimeout((function(){t[o].style.display="none",t[o].classList.remove("slide-out-reverse"),o=(o-1+t.length)%t.length,t[o].style.display="block",t[o].classList.add("slide-in-reverse"),setTimeout((function(){t[o].classList.remove("slide-in-reverse")}),500)}),500)}));for(var s=document.getElementById(`portfolio-${e}`).children,i=document.getElementById("btnNextProyecto-"+e),l=document.getElementById("btnPrevProyecto-"+e),a=0,d=1;d<s.length;d++)s[d].style.display="none";i.addEventListener("click",(function(e){e.preventDefault(),s[a].classList.add("slide-out-left"),setTimeout((function(){s[a].style.display="none",s[a].classList.remove("slide-out-left"),a=(a+1)%s.length,console.log(a),a<s.length?(s[a].style.display="block",s[a].classList.add("slide-in-left")):(s[0].style.display="block",s[a=0].classList.add("slide-in-left")),console.log(s.length),console.log(a),setTimeout((function(){s[a].classList.remove("slide-in-left")}),500)}),500)})),l.addEventListener("click",(function(e){e.preventDefault(),s[a].classList.add("slide-out-right"),setTimeout((function(){s[a].style.display="none",s[a].classList.remove("slide-out-right"),(a=(a-1+s.length)%s.length)>=0?(s[a].style.display="block",s[a].classList.add("slide-in-right")):(s[s.length-1].style.display="block",a=s.length-1,s[a].classList.add("slide-in-right")),console.log(s.length),console.log(a),setTimeout((function(){s[a].classList.remove("slide-in-right")}),500)}),500)}))}chrome.runtime.onMessage.addListener((function(e,t,n){console.log(e),void 0!==e.nombre&&void 0!==e.encendido&&console.log(e.nombre+" was toggled. New state: "+e.encendido)}));let perfilesCargados=[];cargarIntegrantesNeo4j(),crearEncabezado(),agregarBotonACadaFila(),agregarEstilos(),setAnimacionesCarrousel();